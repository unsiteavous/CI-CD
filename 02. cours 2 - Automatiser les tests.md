# Automatiser les tests
Tout ce qui doit Ãªtre fait sur le projet doit Ãªtre installÃ© dans le projet. Si nous voulons faire des tests, nous avons besoin d'installer dans notre repository un outil de test. 

Dans notre cas ici, ce sera [phpunit](https://phpunit.de/index.html).  
Par soucis d'efficacitÃ©, nous travaillerons avec [composer](https://getcomposer.org/) tout du long de ce cours.

Vous pouvez retrouver tous les paquets installables avec **composer** ici : https://packagist.org/explore/

```bash
composer require --dev phpunit/phpunit
```

Dans notre fichier `composer.json`, on aperÃ§oit maintenant notre premier package installÃ© que pour le dev. Que vous fassiez un projet natif ou symfony (ou autre), cela ne change rien.

Ã  prÃ©sent, on peut lancer des tests unitaires avec cette commande : 
```bash
./vendor/bin/phpunit --colors=always --testdox ./src/Tests/Unitaires/ --display-notices --display-deprecations --display-errors --display-warnings --no-coverage
```
Je vous passe le dÃ©tail de tous les drapeaux, que vous pouvez retrouver ici : https://docs.phpunit.de/en/11.4/textui.html#command-line-options

## Feignants
Nous, [les devs](https://fr.wiktionary.org/wiki/feignant), on aime bien faire les choses une fois. Quand on commence Ã  se rÃ©pÃ©ter, c'est qu'on s'est trompÃ© quelque part. 

Quand on me dit que je dois Ã©crire cette ligne Ã  chaque fois que je veux lancer mes tests unitaires, il y a un hic : trop long, dÃ©so ! ğŸ˜‡

Donc dans mon `composer.json`, j'ajoute de quoi lancer cette commande beaucoup plus simplement : 

```bash
{
  [...]

  "scripts": {
    "tests_unitaires": "./vendor/bin/phpunit --colors=always --testdox ./src/Tests/Unitaires/ --display-notices --display-deprecations --display-errors --display-warnings --no-coverage",
  }

}
```

Maintenant je peux lancer cette commande, pour faire la mÃªme chose : 
```bash
composer tests_unitaires
```

## Doublement Feignants
MÃªme avec cette commande raccourcie, c'est toujours trop long. 

> *Attendez, c'est vraiment Ã  moi de lancer la commande tout seul, Ã  chaque fois que je veux faire un commit ?* ğŸ˜³

C'est sÃ»r que je vais oublier (consciemment ou pas d'ailleurs).

On va donc... **Automatiser cette tÃ¢che** !  
ici on a plusieurs maniÃ¨res de faire. Soit on impose des rÃ¨gles qui doivent se rÃ©aliser avant le push (avec [grumphp](https://github.com/phpro/grumphp)), soit on impose des processus Ã  se lancer dans le dÃ©pÃ´t, avec github action ou avec gitlab-ci. Soit les deux (grumphp et github action ou gitlab-ci).

> <br>
> 
> Lorsque vous faites un formulaire avec soumission au back, oÃ¹ faites-vous les vÃ©rifications de donnÃ©es ?
> - [ ] juste en front (grumphp) ? 
> - [ ] juste en back ? (CI) ?
> - [x] les deux ? (Vous l'avez devinÃ©, c'est la bonne rÃ©ponse, bravo ! ğŸ‰)
> 
> <br>

Et oui parce qu'on ne peut pas faire confiance Ã  un dev pour qu'il fasse ses tests correctement, mais qu'il faut quand mÃªme lui laisser la fiertÃ© de pouvoir les faire... 

Bref.

Rendez-vous dans le [cours NÂ°3](<03 cours 3 - GrumPHP.md>).